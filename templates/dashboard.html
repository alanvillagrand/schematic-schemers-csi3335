{% extends "base.html" %}

{% block body %}
    <div class="container">
        <h1>Welcome, {{ username }}!</h1>
        <p>Welcome to your Dashboard</p>

        <!-- Query Input Boxes with Suggestions -->
        <div class="query-box">
            <label for="query1">Enter Query (e.g., .300+ AVG CareerBatting, 10+ HR SeasonBatting, All Star):</label>
            <input type="text" id="query1" name="query1" placeholder="Type a query (e.g., .300+ AVG CareerBatting)" oninput="showSuggestions('query1')" required>
            <div id="suggestions1" class="suggestions"></div> <!-- Suggestions container -->
        </div>

        <div class="query-box">
            <label for="query2">Enter Query (e.g., 10+ HR SeasonBatting, 300+ HR CareerBatting):</label>
            <input type="text" id="query2" name="query2" placeholder="Type a query (e.g., 10+ HR SeasonBatting)" oninput="showSuggestions('query2')" required>
            <div id="suggestions2" class="suggestions"></div> <!-- Suggestions container -->
        </div>

        <!-- Button for user action (no backend interaction yet) -->
        <button type="button" class="btn-submit" onclick="handleQuery()">Submit Query</button>

        <a href="{{ url_for('logout') }}" class="btn-logout">Logout</a>
    </div>

    <!-- JavaScript to handle user input and display live suggestions -->
    <script>
        // List of possible criteria for query matching
        const criteria = [
            ".300+ AVG CareerBatting",
            ".300+ AVG SeasonBatting",
            "10+ HR SeasonBatting",
            "10+ Win SeasonPitching",
            "100+ RBI SeasonBatting",
            "100+ Run SeasonBatting",
            "20+ Win SeasonPitching",
            "200+ Hits SeasonBatting",
            "200+ K SeasonPitching",
            "200+ Wins CareerPitching",
            "2000+ K CareerPitching",
            "2000+ Hits CareerBatting",
            "30+ HR / 30+ SB SeasonBatting",
            "30+ HR SeasonBatting",
            "30+ SB Season",
            "30+ Save SeasonPitching",
            "300+ HR CareerBatting",
            "300+ Save CareerPitching",
            "300+ Wins CareerPitching",
            "3000+ K CareerPitching",
            "3000+ Hits CareerBatting",
            "40+ 2B SeasonBatting",
            "40+ HR SeasonBatting",
            "40+ Save SeasonPitching",
            "40+ WAR Career",
            "500+ HR CareerBatting",
            "6+ WAR Season",
            "All Star",
            "Born Outside US 50 States and DC",
            "Cy Young",
            "Designated Hitter min. 1 game",
            "First Round Draft Pick",
            "Gold Glove",
            "Hall of Fame",
            "MVP",
            "Only One Team",
            "Pitched min. 1 game",
            "Played Catcher min. 1 game",
            "Played Center Field min. 1 game",
            "Played First Base min. 1 game",
            "Played In Major Negro Lgs",
            "Played Left Field min. 1 game",
            "Played Outfield min. 1 game",
            "Played Right Field min. 1 game",
            "Played Second Base min. 1 game",
            "Played Shortstop min. 1 game",
            "Played Third Base min. 1 game",
            "Rookie of the Year",
            "Silver Slugger",
            "Threw a No‑Hitter",
            "World Series Champ WS Roster",
            "≤ 3.00 ERA Career Pitching",
            "≤ 3.00 ERA Season",
            "Played on <team>"
        ];

        // Function to show suggestions as the user types
        function showSuggestions(inputId) {
            const input = document.getElementById(inputId).value.toLowerCase();
            const suggestionsDiv = document.getElementById('suggestions' + inputId.slice(-1)); // Corresponding suggestions div
            suggestionsDiv.innerHTML = ''; // Clear previous suggestions

            // If input is not empty, filter matching options
            if (input) {
                const matches = criteria.filter(option => option.toLowerCase().includes(input));
                matches.forEach(match => {
                    const suggestionItem = document.createElement('div');
                    suggestionItem.classList.add('suggestion-item');
                    suggestionItem.textContent = match;
                    suggestionItem.onclick = () => selectSuggestion(inputId, match);
                    suggestionsDiv.appendChild(suggestionItem);
                });
            }
        }

        // When a suggestion is clicked, fill the input with it
        function selectSuggestion(inputId, suggestion) {
            document.getElementById(inputId).value = suggestion;
            document.getElementById('suggestions' + inputId.slice(-1)).innerHTML = ''; // Clear suggestions
        }

        // Handle the query submission (for demonstration purposes)
        function handleQuery() {
            const query1 = document.getElementById('query1').value.toLowerCase();
            const query2 = document.getElementById('query2').value.toLowerCase();
            let results = '';

            // Handle the first query input
            if (criteria.includes(query1)) {
                results += `Query 1: Searching for ${query1}...<br>`;
            } else {
                results += `Query 1: Invalid query. Please type a valid query.<br>`;
            }

            // Handle the second query input
            if (criteria.includes(query2)) {
                results += `Query 2: Searching for ${query2}...<br>`;
            } else {
                results += `Query 2: Invalid query. Please type a valid query.<br>`;
            }

            // Display results
            const resultsDiv = document.createElement('div');
            resultsDiv.innerHTML = `<h2>Query Results:</h2><p>${results}</p>`;
            document.body.appendChild(resultsDiv);
        }
    </script>

    <!-- CSS for suggestions -->
    <style>
        .suggestions {
            border: 1px solid #ccc;
            max-height: 150px;
            overflow-y: auto;
            margin-top: 5px;
            position: absolute;
            width: 100%;
            background-color: white;
            z-index: 10;
        }

        .suggestion-item {
            padding: 8px;
            cursor: pointer;
        }

        .suggestion-item:hover {
            background-color: #f0f0f0;
        }

        .query-box {
            position: relative;
            margin-bottom: 20px;
        }
    </style>

{% endblock %}
